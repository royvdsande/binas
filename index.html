<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Custom PDF Viewer</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.min.js"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');

    :root {
      color-scheme: light;
      --accent: #2563eb;
      --accent-strong: #1d4ed8;
      --bg: #eef2f7;
      --panel: #ffffff;
      --border: #d6dbe6;
      --text: #0f172a;
      --muted: #4b5563;
    }

    * {
      box-sizing: border-box;
    }

    .no-select {
      user-select: none;
    }

    body {
      margin: 0;
      font-family: 'Inter', system-ui, -apple-system, sans-serif;
      background: var(--bg);
      color: var(--text);
      min-height: 100vh;
    }

    .layout {
      display: grid;
      grid-template-columns: 320px 1fr;
      min-height: 100vh;
      height: 100vh;
      background: #ffffff;
    }

    .brand {
      display: inline-flex;
      align-items: center;
      gap: 10px;
      padding: 12px 10px 6px 10px;
      color: #0f172a;
    }

    .brand svg {
      width: 30px;
      height: 30px;
      color: var(--accent);
      flex-shrink: 0;
    }

    .brand .text {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .brand-title {
      margin: 0;
      font-size: 16px;
      font-weight: 800;
      letter-spacing: -0.01em;
    }

    .brand-subtitle {
      margin: 0;
      font-size: 12px;
      color: var(--muted);
      font-weight: 600;
    }

    .file-picker {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 10px 12px;
      border: 1px dashed var(--border);
      border-radius: 6px;
      background: #f8fafc;
      width: 100%;
    }

    .file-picker label {
      font-weight: 700;
      color: #0f172a;
      font-size: 14px;
      white-space: nowrap;
    }

    .file-picker input[type='file'] {
      width: 100%;
      font-size: 14px;
    }

    main {
      display: contents;
    }

    .content {
      display: contents;
    }

    .sidebar {
      border-right: 1px solid var(--border);
      background: #f8fafc;
      padding: 16px 14px;
      display: flex;
      flex-direction: column;
      gap: 12px;
      height: 100vh;
      overflow: hidden;
    }

    .sidebar-top {
      display: flex;
      flex-direction: column;
      gap: 12px;
      position: sticky;
      top: 0;
      background: #f8fafc;
      z-index: 2;
      padding-bottom: 4px;
    }

    .sidebar h2 {
      margin: 0;
      font-size: 15px;
      font-weight: 800;
      color: #0f172a;
    }

    .nav-header {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .nav-area {
      display: flex;
      flex-direction: column;
      gap: 10px;
      flex: 1;
      min-height: 0;
    }

    .nav-scroll {
      overflow: auto;
      padding-right: 2px;
      flex: 1;
      min-height: 0;
    }

    .search-box {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 8px 10px;
      background: #ffffff;
      border: 1px solid var(--border);
      border-radius: 6px;
    }

    .search-box svg {
      width: 18px;
      height: 18px;
    }

    .search-box input {
      border: none;
      outline: none;
      width: 100%;
      font-size: 14px;
      color: var(--text);
      background: transparent;
    }

    .nav-list {
      list-style: none;
      margin: 0;
      padding: 0;
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .nav-group {
      border: 1px solid var(--border);
      border-radius: 6px;
      background: #ffffff;
      overflow: hidden;
      box-shadow: 0 6px 12px rgba(15, 23, 42, 0.06);
    }

    .nav-group-header {
      padding: 8px 10px;
      background: #f1f5f9;
      font-weight: 800;
      font-size: 13px;
      color: #1f2937;
      border-bottom: 1px solid var(--border);
    }

    .nav-group ul {
      list-style: none;
      margin: 0;
      padding: 0;
    }

    .nav-sublist {
      padding-left: 12px;
      border-left: 2px dashed #e5e7eb;
    }

    .nav-item {
      display: grid;
      grid-template-columns: 1fr auto;
      gap: 6px;
      align-items: center;
      width: 100%;
      padding: 8px 10px;
      border: none;
      background: transparent;
      text-align: left;
      cursor: pointer;
      transition: background 0.15s ease, color 0.15s ease;
      font-weight: 600;
      color: #111827;
    }

    .nav-item:hover {
      background: #eef3ff;
      color: #1d4ed8;
    }

    .nav-item .meta {
      font-size: 12px;
      color: var(--muted);
      font-weight: 700;
    }

    .toolbar {
      display: flex;
      align-items: center;
      gap: 6px;
      padding: 8px 12px;
      border-bottom: 1px solid var(--border);
      background: #ffffff;
      position: sticky;
      top: 0;
      z-index: 2;
      flex-wrap: wrap;
    }

    .toolbar-group {
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    button {
      border: 1px solid var(--border);
      background: #ffffff;
      color: #111827;
      padding: 6px 8px;
      border-radius: 6px;
      cursor: pointer;
      font-weight: 700;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      transition: background 0.15s ease, border-color 0.15s ease, transform 0.1s ease;
      min-width: 34px;
      min-height: 34px;
    }

    button svg {
      width: 18px;
      height: 18px;
    }

    .toolbar button span {
      display: none;
    }

    button:hover:not(:disabled) {
      background: #eef3ff;
      border-color: #c9d7ff;
      transform: translateY(-1px);
    }

    button:disabled {
      opacity: 0.6;
      cursor: not-allowed;
    }

    .primary {
      background: #2563eb;
      color: #ffffff;
      border-color: #1d4ed8;
    }

    .primary:hover:not(:disabled) {
      background: #1d4ed8;
      border-color: #1e40af;
    }

    .toolbar-status {
      margin-left: auto;
      display: inline-flex;
      gap: 8px;
      align-items: center;
      font-weight: 700;
      color: var(--muted);
      flex-wrap: wrap;
    }

    .badge {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      background: #eef2ff;
      color: #1d4ed8;
      border-radius: 10px;
      padding: 6px 10px;
      border: 1px solid #dbe4ff;
      font-weight: 700;
    }

    .viewer {
      display: flex;
      flex-direction: column;
      min-height: 100vh;
      height: 100vh;
      background: #ffffff;
    }

    .viewer-area {
      flex: 1;
      background: #f7f9fb;
      padding: 0;
      overflow: auto;
      height: 100%;
    }

    .page-grid {
      display: grid;
      gap: 16px;
      justify-content: center;
      grid-template-columns: repeat(1, minmax(260px, 1fr));
      align-items: start;
      padding: 16px;
    }

    .page-grid.spread {
      grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
    }

    .page-wrapper {
      background: transparent;
      border-radius: 0;
      border: none;
      box-shadow: none;
      padding: 0;
      position: relative;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .page-label {
      position: absolute;
      top: 8px;
      left: 8px;
      background: rgba(15, 23, 42, 0.75);
      color: #ffffff;
      padding: 4px 8px;
      border-radius: 8px;
      font-size: 12px;
      font-weight: 700;
      letter-spacing: 0.02em;
    }

    canvas.page-canvas {
      width: 100%;
      height: auto;
      background: #ffffff;
      border: 1px solid #e5e7eb;
    }

    .empty-state {
      text-align: center;
      padding: 50px 16px;
      color: var(--muted);
      display: grid;
      gap: 12px;
      justify-items: center;
    }

    .empty-state svg {
      width: 72px;
      height: 72px;
      color: var(--accent);
    }
  </style>
</head>
<body>
  <div class="layout">
    <aside class="sidebar" aria-label="Inhoud van Binas">
      <div class="sidebar-top">
        <div class="brand no-select" aria-label="PDF viewer">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
            <path d="M6 3h9l3 3v15H6z" />
            <path d="M15 3v3h3" />
            <path d="M9 12h3M9 16h6" />
            <path d="M9 8h2" />
          </svg>
          <div class="text">
            <p class="brand-title">Binas PDF Studio</p>
            <p class="brand-subtitle">Overzicht & snelle toegang</p>
          </div>
        </div>
        <div class="file-picker">
          <label class="no-select" for="file-input">Bestand</label>
          <input id="file-input" type="file" accept="application/pdf" />
        </div>
        <div class="nav-header">
          <h2 class="no-select">Onderwerpen</h2>
          <div class="search-box">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
              <circle cx="11" cy="11" r="7" />
              <line x1="16.5" y1="16.5" x2="21" y2="21" />
            </svg>
            <input id="nav-search" type="search" placeholder="Zoek op tabel of naam" />
          </div>
        </div>
      </div>
      <div class="nav-area">
        <div class="nav-scroll">
          <ul class="nav-list" id="nav-list" aria-live="polite"></ul>
        </div>
      </div>
    </aside>

    <div class="viewer">
      <div class="toolbar">
        <div class="toolbar-group" aria-label="Navigatie">
          <button id="prev-page" title="Vorige pagina">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M15 18l-6-6 6-6" />
            </svg>
            <span>Vorige</span>
          </button>
          <button id="next-page" title="Volgende pagina">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M9 6l6 6-6 6" />
            </svg>
            <span>Volgende</span>
          </button>
        </div>

        <div class="toolbar-group" aria-label="Zoom">
          <button id="zoom-out" title="Uitzoomen">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <circle cx="11" cy="11" r="7" />
              <line x1="8" y1="11" x2="14" y2="11" />
              <line x1="16.5" y1="16.5" x2="21" y2="21" />
            </svg>
            <span>Uitzoomen</span>
          </button>
          <button id="zoom-in" title="Inzoomen">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <circle cx="11" cy="11" r="7" />
              <line x1="11" y1="8" x2="11" y2="14" />
              <line x1="8" y1="11" x2="14" y2="11" />
              <line x1="16.5" y1="16.5" x2="21" y2="21" />
            </svg>
            <span>Inzoomen</span>
          </button>
          <button id="fit-height" title="Schaal tot hoogte">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <rect x="5" y="3" width="14" height="18" rx="2" />
              <polyline points="12 7 9 10 12 13" />
              <polyline points="12 17 15 14 12 11" />
            </svg>
            <span>Hoogte</span>
          </button>
          <button id="fit-width" title="Schaal tot breedte">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <rect x="3" y="6" width="18" height="12" rx="2" />
              <polyline points="7 12 10 9 10 15 7 12" />
              <polyline points="17 12 14 9 14 15 17 12" />
            </svg>
            <span>Breedte</span>
          </button>
          <button id="reset-zoom" title="Reset zoom">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <polyline points="1 4 1 10 7 10" />
              <polyline points="23 20 23 14 17 14" />
              <path d="M20.49 9A9 9 0 0 0 6.15 4.36L1 10" />
              <path d="M3.51 15A9 9 0 0 0 17.85 19.64L23 14" />
            </svg>
            <span>Reset</span>
          </button>
        </div>

        <div class="toolbar-group" aria-label="Weergave">
          <button id="toggle-view" class="primary" title="Schakel tussen 1 of 2 pagina's">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <rect x="3" y="4" width="8" height="16" rx="2" />
              <rect x="13" y="4" width="8" height="16" rx="2" />
            </svg>
            <span>Weergave</span>
          </button>
        </div>

        <div class="toolbar-status no-select">
          <span id="page-status">Pagina – / –</span>
          <span aria-hidden="true">•</span>
          <span id="zoom-status" class="badge">Zoom: 100%</span>
        </div>
      </div>

      <div class="viewer-area">
        <div class="page-grid" id="page-grid">
          <div class="empty-state" id="empty-state">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
              <rect x="3" y="3" width="18" height="18" rx="2" ry="2" />
              <path d="M7 7h10v10H7z" />
              <path d="M7 13h6" />
            </svg>
            <div>
              <strong>Upload een PDF om te beginnen</strong>
            </div>
            <div>Volledig scherm, snelle navigatie en 2-pagina weergave.</div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    const pdfjsLib = window['pdfjs-dist/build/pdf'];
    pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.worker.min.js';

    const fileInput = document.getElementById('file-input');
    const pageGrid = document.getElementById('page-grid');
    const emptyState = document.getElementById('empty-state');
    const navList = document.getElementById('nav-list');
    const navSearch = document.getElementById('nav-search');

    const prevBtn = document.getElementById('prev-page');
    const nextBtn = document.getElementById('next-page');
    const zoomInBtn = document.getElementById('zoom-in');
    const zoomOutBtn = document.getElementById('zoom-out');
    const fitHeightBtn = document.getElementById('fit-height');
    const fitWidthBtn = document.getElementById('fit-width');
    const resetZoomBtn = document.getElementById('reset-zoom');
    const toggleViewBtn = document.getElementById('toggle-view');
    const pageStatus = document.getElementById('page-status');
    const zoomStatus = document.getElementById('zoom-status');
    const viewerArea = document.querySelector('.viewer-area');

    let pdfDoc = null;
    let currentPage = 1;
    let scale = 1;
    let isSpread = false;
    const minScale = 0.5;
    const maxScale = 3;
    const scaleStep = 0.15;

    const navigationData = [
      {
        section: 'Algemeen',
        items: [
          { title: 'Grieks alfabet', page: 6 },
          { title: 'Vermenigvuldigingsfactoren', page: 8 },
          { title: 'Basisgrootheden en grondeenheden in het SI', page: 10 },
          { title: 'Grootheden en eenheden in het SI', page: 12 },
          { title: 'Omrekencoefficiënten van eenheden', page: 18 },
          {
            title: 'Machten van tien',
            page: 20,
            children: [
              { title: 'A. Massa', page: 21 },
              { title: 'B. Tijd', page: 22 },
              { title: 'C. Temperatuur', page: 23 },
              { title: 'D. Energie', page: 24 },
            ],
          },
        ],
      },
      {
        section: 'Natuurkunde',
        items: [
          {
            title: '7 – Waarden van enige constanten',
            page: 28,
            children: [
              { title: 'A. Natuurconstanten', page: 29 },
              { title: 'B. Massa en energie', page: 31 },
              { title: 'C. Planck-eenheden', page: 32 },
            ],
          },
          { title: '8 – Gegevens van metalen', page: 35 },
          { title: '9 – Gegevens van vlamgassen', page: 40 },
          {
            title: '10 – Gegevens van vaste stoffen',
            page: 45,
            children: [
              { title: 'A. Fysische eigenschappen', page: 46 },
              { title: 'B. Materiaaleigenschappen', page: 48 },
            ],
          },
          { title: '11 – Gegevens van vloeistoffen', page: 52 },
          { title: '12 – Gegevens van gassen en dampen', page: 58 },
          {
            title: '13 – Verzadigingsdrukken',
            page: 64,
            children: [
              { title: 'A. Water', page: 65 },
              { title: 'B. CO₂, propaan, butaan, etheen, alcohol, water', page: 66 },
            ],
          },
          { title: '14 – Kook- en smeltpunten', page: 70 },
          {
            title: '15 – Geluid',
            page: 76,
            children: [
              { title: 'A. Voortplantingssnelheden', page: 77 },
              { title: 'B. Absorptiecoëfficiënten', page: 78 },
              { title: 'C. Muziek', page: 80 },
              { title: 'D. Akoestische schaal voor de mens', page: 82 },
            ],
          },
          {
            title: '16 – Elektriciteit en magnetisme',
            page: 86,
            children: [
              { title: 'A. Relatieve diëlektrische constanten', page: 87 },
              { title: 'B. Soorten magneten', page: 88 },
              { title: 'C. Halogeenlampen en spaarlampen', page: 90 },
              { title: 'D. Thermo-elektriciteit', page: 92 },
              { title: 'E. Elektromagneten', page: 93 },
              { title: 'F. Kleuren', page: 94 },
              { title: 'G. Elektrotechnische symbolen', page: 96 },
              { title: 'H. Digitale schakelingen', page: 98 },
            ],
          },
          { title: '17 – Brekingsindices', page: 102 },
          {
            title: '18 – Elektromagnetisch spectrum',
            page: 108,
            children: [
              { title: 'A. Zichtbaar licht', page: 109 },
              { title: 'B. Algemeen overzicht', page: 110 },
            ],
          },
          { title: '19 – Spectraallijnen', page: 116 },
          {
            title: '20 – Atoomfysica',
            page: 120,
            children: [
              { title: 'A. Als bolmodel', page: 121 },
              { title: 'B. Ionisatie-energieën', page: 123 },
              { title: 'C. Plasma', page: 125 },
              { title: 'D. Spectra', page: 126 },
            ],
          },
          { title: '21 – Planck-krommen', page: 130 },
        ],
      },
      {
        section: 'Natuurkunde vervolg',
        items: [
          { title: '23 – Quantummechanica', page: 136 },
          { title: '24 – Foto-elektrisch effect', page: 140 },
          {
            title: '25 – Isotopen',
            page: 146,
            children: [
              { title: 'A. Isotopenblad', page: 147 },
              { title: 'B. Isotopenkaart', page: 150 },
            ],
          },
          {
            title: '26 – Bouw en structuur van de materie',
            page: 154,
            children: [
              { title: 'A. Elementaire deeltjes', page: 155 },
              { title: 'B. Wisselwerkingsdeeltjes', page: 157 },
              { title: 'C. Hadronen', page: 158 },
            ],
          },
          {
            title: '27 – Biofysica',
            page: 162,
            children: [
              { title: 'A. Zicht', page: 163 },
              { title: 'B. UV en huid', page: 164 },
              { title: 'C. Geluid', page: 165 },
              { title: 'D. Radioactiviteit', page: 167 },
            ],
          },
          {
            title: '28 – Fysica en milieu',
            page: 170,
            children: [
              { title: 'A. Luchtverontreiniging', page: 171 },
              { title: 'B. Stofconcentraties', page: 172 },
              { title: 'C. Lichtabsorptie in water', page: 173 },
              { title: 'D. Radioactiviteit – U-waarden', page: 174 },
              { title: 'E. Geïoniseerde lucht', page: 176 },
              { title: 'F. Bouwen/verbranding', page: 177 },
            ],
          },
          {
            title: '29 – Medische beeldvorming',
            page: 180,
            children: [
              { title: 'A. Röntgen', page: 181 },
              { title: 'B. Echo', page: 182 },
              { title: 'C. MRI', page: 184 },
              { title: 'D. PET', page: 186 },
            ],
          },
          { title: '30 – Kosmische straling', page: 190 },
          {
            title: '31 – Sterren',
            page: 194,
            children: [
              { title: 'A. Sterren en stelsels', page: 195 },
              { title: 'B. HR-diagram', page: 197 },
              { title: 'C. Kosmologie', page: 199 },
            ],
          },
          {
            title: '32 – Evolutie van sterren',
            page: 202,
            children: [
              { title: 'A. Stervorming', page: 203 },
              { title: 'B. Sterren', page: 205 },
              {
                title: 'C. Beëindiging',
                page: 208,
                children: [
                  { title: '1. Melkweg', page: 209 },
                  { title: '2. Lokale groep', page: 210 },
                  { title: '3. Clusters', page: 211 },
                ],
              },
              { title: 'D. Achtergrondstraling', page: 214 },
              { title: 'E. Oerknal', page: 216 },
            ],
          },
        ],
      },
      {
        section: 'Wiskunde',
        items: [
          {
            title: '36 – Wiskundeformules',
            page: 222,
            children: [
              { title: 'A. Verhoudingen', page: 223 },
              { title: 'B. Lengtes/oppervlakken/volumes', page: 224 },
              { title: 'C. Vertaaloefeningen', page: 226 },
              { title: 'D. Machten/logaritmen', page: 228 },
              { title: 'E. Cirkel/ellips/hyperbool', page: 230 },
              { title: 'F. Differentiëren/integreren', page: 232 },
              { title: 'G. Goniometrie', page: 236 },
              { title: 'H. Rijen en reeksen', page: 238 },
              { title: 'I. Notaties', page: 239 },
            ],
          },
        ],
      },
      {
        section: 'Scheikunde',
        items: [
          {
            title: '37 – Scheikundeformules',
            page: 244,
            children: [
              { title: 'A. Reactiesnelheid', page: 245 },
              { title: 'B. Evenwicht', page: 246 },
              { title: 'C. Thermodynamica', page: 248 },
              { title: 'D. Elektrochemie', page: 250 },
              { title: 'E. Spectrometrie', page: 252 },
              { title: 'F. Chromatografie', page: 254 },
              { title: 'G. Basiswaarden', page: 255 },
              { title: 'H. Hoeveelheid stof', page: 256 },
              { title: 'I. Zuurmaat', page: 257 },
            ],
          },
          {
            title: '38 – Scheikunde symbolen',
            page: 260,
            children: [
              { title: 'A. Symbolen/eenheden', page: 261 },
              { title: 'B. Structuurformules', page: 262 },
            ],
          },
          {
            title: '39 – Spectrometrie',
            page: 266,
            children: [
              { title: 'A. UV/Vis', page: 267 },
              { title: 'B. NMR', page: 268 },
              { title: 'C. IR', page: 270 },
              { title: 'D. Massa', page: 272 },
            ],
          },
          {
            title: '40 – Elementen',
            page: 276,
            children: [
              { title: 'A. Gegevens', page: 277 },
              { title: 'B. Oplosbaarheid/kernmassa', page: 278 },
            ],
          },
          { title: '41 – Molair/molecuulgebonden', page: 282 },
          { title: '42 – Smelt- en kookpunten', page: 284 },
          { title: '43 – Oplosbaarheid van bindingen', page: 286 },
          { title: '44 – Dichterheden en molaire massa’s', page: 288 },
          { title: '45 – Dampdrukken', page: 292 },
          { title: '46 – Evenwichtsreacties in water', page: 294 },
          { title: '47 – Evenwicht zuren/basen', page: 295 },
          { title: '48 – Sterk/zwak zuur', page: 298 },
          { title: '49 – Zuur-base diagrammen', page: 300 },
          {
            title: '50 – Ionisatieconstanten',
            page: 302,
            children: [{ title: 'A. Water', page: 303 }],
          },
          {
            title: '51 – Bindingseigenschappen',
            page: 304,
            children: [{ title: 'A. Bindingslengte', page: 305 }],
          },
          { title: '52 – Evenwichtsconstanten', page: 306 },
          {
            title: '53 – Indicatoren',
            page: 308,
            children: [{ title: 'A. Zuur-/base-indicatoren', page: 309 }],
          },
          {
            title: '54 – Reactiemechanismen',
            page: 310,
            children: [
              { title: 'A. SN2', page: 311 },
              { title: 'B. SN1', page: 312 },
              { title: 'C. Eliminatie SN1/SN2', page: 313 },
              { title: 'D. Eliminatie', page: 314 },
              { title: 'E. E1', page: 315 },
              { title: 'F. E2', page: 316 },
            ],
          },
          { title: '55 – Verbindingen en bindingen', page: 317 },
          { title: '56 – Vormingstemperaturen', page: 318 },
        ],
      },
    ];

    function updatePageStatus() {
      if (!pdfDoc) {
        pageStatus.textContent = 'Pagina – / –';
        return;
      }
      if (isSpread) {
        const secondPage = Math.min(currentPage + 1, pdfDoc.numPages);
        const range = secondPage !== currentPage ? `${currentPage}–${secondPage}` : `${currentPage}`;
        pageStatus.textContent = `Pagina ${range} / ${pdfDoc.numPages}`;
        return;
      }
      pageStatus.textContent = `Pagina ${currentPage} / ${pdfDoc.numPages}`;
    }

    function updateZoomStatus() {
      zoomStatus.textContent = `Zoom: ${(scale * 100).toFixed(0)}%`;
    }

    function updateButtons() {
      const hasDoc = Boolean(pdfDoc);
      prevBtn.disabled = !hasDoc || currentPage <= 1;
      const maxForNext = isSpread && pdfDoc ? pdfDoc.numPages - 1 : pdfDoc?.numPages ?? 0;
      nextBtn.disabled = !hasDoc || currentPage >= maxForNext;
      zoomInBtn.disabled = !hasDoc || scale >= maxScale;
      zoomOutBtn.disabled = !hasDoc || scale <= minScale;
      fitHeightBtn.disabled = !hasDoc;
      fitWidthBtn.disabled = !hasDoc;
      resetZoomBtn.disabled = !hasDoc || scale === 1;
      toggleViewBtn.disabled = !hasDoc;
    }

    async function renderPages() {
      if (!pdfDoc) return;

      pageGrid.innerHTML = '';
      const pagesToRender = isSpread
        ? [currentPage, currentPage + 1].filter((pageNumber) => pageNumber && pageNumber <= pdfDoc.numPages)
        : [currentPage];

      pageGrid.classList.toggle('spread', isSpread && pagesToRender.length > 1);

      for (const pageNumber of pagesToRender) {
        const page = await pdfDoc.getPage(pageNumber);
        const viewport = page.getViewport({ scale });

        const canvas = document.createElement('canvas');
        canvas.className = 'page-canvas';
        canvas.width = viewport.width;
        canvas.height = viewport.height;

        const renderContext = {
          canvasContext: canvas.getContext('2d'),
          viewport,
        };

        await page.render(renderContext).promise;

        const wrapper = document.createElement('div');
        wrapper.className = 'page-wrapper';
        const label = document.createElement('span');
        label.className = 'page-label';
        label.textContent = `Pagina ${pageNumber}`;
        wrapper.appendChild(canvas);
        wrapper.appendChild(label);
        pageGrid.appendChild(wrapper);
      }

      updatePageStatus();
      updateZoomStatus();
      updateButtons();
    }

    function clampZoom(newScale) {
      return Math.min(maxScale, Math.max(minScale, newScale));
    }

    function changeZoom(delta) {
      if (!pdfDoc) return;
      scale = clampZoom(scale + delta);
      renderPages();
    }

    async function setZoomToFitWidth() {
      if (!pdfDoc || !viewerArea) return;
      const page = await pdfDoc.getPage(currentPage);
      const viewport = page.getViewport({ scale: 1 });
      const columns = isSpread ? 2 : 1;
      const gridPadding = 32;
      const columnGap = 16;
      const availableWidth = Math.max(120, viewerArea.clientWidth - gridPadding - columnGap * (columns - 1));
      const targetWidth = availableWidth / columns;
      scale = clampZoom(targetWidth / viewport.width);
      renderPages();
    }

    async function setZoomToFitHeight() {
      if (!pdfDoc || !viewerArea) return;
      const page = await pdfDoc.getPage(currentPage);
      const viewport = page.getViewport({ scale: 1 });
      const gridPadding = 32;
      const availableHeight = Math.max(120, viewerArea.clientHeight - gridPadding);
      scale = clampZoom(availableHeight / viewport.height);
      renderPages();
    }

    function resetZoom() {
      if (!pdfDoc) return;
      scale = 1;
      renderPages();
    }

    function changePage(direction) {
      if (!pdfDoc) return;
      const step = isSpread ? 2 : 1;
      let target = currentPage + direction * step;
      if (target < 1) target = 1;
      const upperBound = isSpread && pdfDoc.numPages > 1 ? pdfDoc.numPages - 1 : pdfDoc.numPages;
      if (target > upperBound) target = upperBound;
      currentPage = target;
      renderPages();
    }

    function goToPage(targetPage) {
      if (!pdfDoc) return;
      let normalized = Math.min(pdfDoc.numPages, Math.max(1, targetPage));
      if (isSpread && normalized % 2 === 0) {
        normalized = Math.max(1, normalized - 1);
      }
      currentPage = normalized;
      renderPages();
    }

    async function openPdf(arrayBuffer) {
      const loadingTask = pdfjsLib.getDocument({ data: arrayBuffer });
      pdfDoc = await loadingTask.promise;
      currentPage = 1;
      scale = 1;
      emptyState?.remove();
      renderPages();
    }

    function toggleView() {
      isSpread = !isSpread;
      if (isSpread && currentPage % 2 === 0) {
        currentPage = Math.max(1, currentPage - 1);
      }
      if (pdfDoc) {
        renderPages();
      }
    }

    function filterItems(items, query) {
      return items
        .map((item) => {
          const matches = !query || item.title.toLowerCase().includes(query);
          const children = item.children ? filterItems(item.children, query) : [];
          if (matches || children.length) {
            return { ...item, children };
          }
          return null;
        })
        .filter(Boolean);
    }

    function renderEntries(items, container) {
      items.forEach((item) => {
        const listItem = document.createElement('li');
        const button = document.createElement('button');
        button.className = 'nav-item';
        button.innerHTML = `<span>${item.title}</span><span class="meta">p. ${item.page}</span>`;
        button.addEventListener('click', () => goToPage(item.page));
        listItem.appendChild(button);
        container.appendChild(listItem);

        if (item.children?.length) {
          const subList = document.createElement('ul');
          subList.className = 'nav-sublist';
          renderEntries(item.children, subList);
          container.appendChild(subList);
        }
      });
    }

    function renderNavigation(query = '') {
      if (!navList) return;
      navList.innerHTML = '';
      const normalizedQuery = query.trim().toLowerCase();

      navigationData.forEach((group) => {
        const filteredItems = filterItems(group.items, normalizedQuery);
        if (!filteredItems.length) return;

        const groupItem = document.createElement('li');
        groupItem.className = 'nav-group';

        const header = document.createElement('div');
        header.className = 'nav-group-header';
        header.textContent = group.section;
        groupItem.appendChild(header);

        const groupList = document.createElement('ul');
        renderEntries(filteredItems, groupList);
        groupItem.appendChild(groupList);

        navList.appendChild(groupItem);
      });

      if (!navList.children.length) {
        const emptyItem = document.createElement('li');
        emptyItem.textContent = 'Geen resultaten gevonden.';
        emptyItem.style.padding = '12px';
        emptyItem.style.color = 'var(--muted)';
        navList.appendChild(emptyItem);
      }
    }

    fileInput.addEventListener('change', (event) => {
      const file = event.target.files?.[0];
      if (!file) return;
      const reader = new FileReader();
      reader.onload = (e) => {
        const arrayBuffer = e.target.result;
        openPdf(arrayBuffer);
      };
      reader.readAsArrayBuffer(file);
    });

    prevBtn.addEventListener('click', () => changePage(-1));
    nextBtn.addEventListener('click', () => changePage(1));
    zoomInBtn.addEventListener('click', () => changeZoom(scaleStep));
    zoomOutBtn.addEventListener('click', () => changeZoom(-scaleStep));
    fitHeightBtn.addEventListener('click', setZoomToFitHeight);
    fitWidthBtn.addEventListener('click', setZoomToFitWidth);
    resetZoomBtn.addEventListener('click', resetZoom);
    toggleViewBtn.addEventListener('click', toggleView);

    viewerArea?.addEventListener(
      'wheel',
      (event) => {
        if (!pdfDoc) return;
        if (event.ctrlKey || event.metaKey) {
          event.preventDefault();
          const delta = event.deltaY > 0 ? -scaleStep : scaleStep;
          changeZoom(delta);
        }
      },
      { passive: false }
    );

    navSearch?.addEventListener('input', (event) => {
      renderNavigation(event.target.value);
    });

    renderNavigation();

    updatePageStatus();
    updateZoomStatus();
    updateButtons();
  </script>
</body>
</html>
